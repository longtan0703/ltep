<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 丙午年 | 命定晶石運勢解析</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">

    <style>
        :root {
            --bg-color: #0b0e14; 
            --card-bg: rgba(22, 26, 35, 0.85);
            --accent-gold: #d4af37; 
            --accent-gold-dim: #8a7026;
            --text-main: #f5f5f5;
            --text-muted: #9ea4b0;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            background-color: var(--bg-color);
            background-image: radial-gradient(circle at 50% 0%, #1f2636 0%, var(--bg-color) 90%);
            color: var(--text-main);
            font-family: 'Noto Sans TC', sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 40px 20px;
        }

        h1, h2, h3, h4 { font-family: 'Playfair Display', serif; color: var(--accent-gold); }

        .container { width: 100%; max-width: 700px; position: relative; z-index: 1; }

        .header { text-align: center; margin-bottom: 45px; animation: fadeIn 1.5s ease; }
        .header h1 { font-size: 2.4rem; letter-spacing: 1px; margin-bottom: 10px; background: linear-gradient(to right, #bf953f, #fcf6ba, #b38728); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .header p { font-size: 0.8rem; color: var(--text-muted); letter-spacing: 3px; text-transform: uppercase; }

        /* 卡片樣式 */
        .card {
            background: var(--card-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(212, 175, 55, 0.2);
            padding: 45px;
            border-radius: 16px;
            box-shadow: 0 25px 80px rgba(0,0,0,0.5);
            transition: all 0.5s ease;
        }

        /* 表單元件 */
        .input-group { margin-bottom: 25px; }
        .input-group label { display: block; margin-bottom: 10px; color: var(--accent-gold); font-size: 0.95rem; letter-spacing: 1px; }
        
        .form-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; }
        
        input, select {
            width: 100%; padding: 14px;
            background: rgba(0,0,0,0.4);
            border: 1px solid #3a3f4b; border-radius: 6px;
            color: #fff; font-size: 1rem; outline: none;
            font-family: 'Noto Sans TC', sans-serif;
            transition: 0.3s;
        }
        input:focus, select:focus { border-color: var(--accent-gold); box-shadow: 0 0 15px rgba(212, 175, 55, 0.15); }

        /* 通用按鈕樣式 */
        .btn-main {
            width: 100%; padding: 16px;
            background: linear-gradient(135deg, #a67c00, #d4af37);
            border: none; border-radius: 6px;
            color: #0b0e14; font-weight: 600; font-size: 1.1rem;
            cursor: pointer; letter-spacing: 2px;
            transition: all 0.3s; box-shadow: 0 10px 20px rgba(0,0,0,0.2);
            display: block; text-decoration: none; text-align: center;
        }
        .btn-main:hover { transform: translateY(-3px); box-shadow: 0 15px 30px rgba(212, 175, 55, 0.3); filter: brightness(1.1); }

        .btn-ghost {
            background: transparent; 
            border: 1px solid var(--accent-gold); 
            color: var(--accent-gold);
        }
        .btn-ghost:hover { background: rgba(212, 175, 55, 0.1); }

        /* 結果區樣式 */
        #result-section { display: none; animation: slideUp 0.8s cubic-bezier(0.2, 1, 0.3, 1); }

        .year-tag {
            display: inline-block; margin-bottom: 25px;
            border: 1px solid var(--accent-gold); color: var(--accent-gold);
            padding: 6px 18px; border-radius: 50px; font-size: 0.8rem; letter-spacing: 1.5px;
        }

        .missing-element-display { text-align: center; margin-bottom: 40px; }
        .element-big {
            font-size: 3.5rem; color: var(--text-main);
            text-shadow: 0 0 30px var(--accent-gold-dim);
            font-family: 'Playfair Display', serif; margin: 10px 0;
        }

        /* 運勢文字區 */
        .fortune-block {
            text-align: left; margin-bottom: 30px;
            border-left: 2px solid var(--accent-gold-dim);
            padding-left: 20px;
        }
        .fortune-block h3 { font-size: 1.1rem; margin-bottom: 15px; color: #fff; }
        .fortune-block p { font-size: 0.95rem; line-height: 1.8; color: #ccc; margin-bottom: 20px; text-align: justify; }
        
        .highlight-text { color: var(--accent-gold); font-weight: 500; }

        /* 水晶推薦區 */
        .crystal-section-title {
            text-align: center; margin: 30px 0 20px 0;
            font-size: 1.1rem; color: var(--accent-gold);
            position: relative;
        }
        .crystal-section-title::before, .crystal-section-title::after {
            content: ''; position: absolute; top: 50%; width: 50px; height: 1px; background: var(--accent-gold-dim);
        }
        .crystal-section-title::before { left: 20px; }
        .crystal-section-title::after { right: 20px; }

        .crystal-card {
            display: flex; align-items: center; gap: 25px;
            background: rgba(212, 175, 55, 0.06);
            padding: 25px; border-radius: 12px;
            margin-bottom: 20px;
            border: 1px solid rgba(212, 175, 55, 0.15);
            transition: transform 0.3s ease;
        }
        .crystal-card:hover { background: rgba(212, 175, 55, 0.1); transform: translateX(5px); }

        .crystal-img-wrapper {
            flex-shrink: 0; width: 100px; height: 100px;
            border-radius: 50%; overflow: hidden;
            border: 2px solid var(--accent-gold);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
            background: #000;
            /* 預先加載背景色，避免圖片載入前黑一片 */
            background: linear-gradient(45deg, #1a1a1a, #2a2a2a); 
        }

        .crystal-img-wrapper img {
            width: 100%; height: 100%; object-fit: cover;
            transition: transform 0.5s, opacity 0.5s;
            opacity: 0; /* 初始隱藏，載入後顯示 */
        }
        .crystal-img-wrapper img.loaded { opacity: 1; }

        .crystal-card:hover .crystal-img-wrapper img { transform: scale(1.1); }
        .crystal-content h4 { font-size: 1.1rem; margin-bottom: 6px; color: var(--accent-gold); }
        .crystal-content p { font-size: 0.9rem; color: #d1d1d1; line-height: 1.5; }

        /* RWD */
        @media (max-width: 600px) {
            .form-row { grid-template-columns: 1fr; }
            .crystal-card { flex-direction: column; text-align: center; gap: 15px; }
            .fortune-block { border-left: none; border-top: 2px solid var(--accent-gold-dim); padding-left: 0; padding-top: 20px; }
            .container { padding: 20px; }
            .card { padding: 30px 20px; }
            .crystal-section-title::before, .crystal-section-title::after { display: none; }
        }

        /* Loading */
        .loader {
            display: none; width: 50px; height: 50px; margin: 30px auto;
            border: 3px solid rgba(255,255,255,0.1); border-radius: 50%;
            border-top-color: var(--accent-gold);
            animation: spin 1s ease-in-out infinite;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        @keyframes slideUp { from { opacity: 0; transform: translateY(40px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    </style>
</head>
<body>

    <div class="container">
        <div class="header">
            <h1>CELESTIAL 2026</h1>
            <p>Prophecy & Crystal Healing Guide</p>
        </div>

        <div class="card" id="input-card">
            <div class="input-group">
                <label>您的國曆生日</label>
                <div class="form-row">
                    <input type="number" id="year" placeholder="年 (YYYY)" min="1940" max="2025">
                    <select id="month"><option value="" disabled selected>月</option></select>
                    <select id="day"><option value="" disabled selected>日</option></select>
                </div>
            </div>

            <div class="input-group">
                <label>出生時辰</label>
                <select id="hour">
                    <option value="" disabled selected>請選擇時辰</option>
                    <option value="-1">✦ 我不知道出生時間</option>
                    <option value="0">子時 (23:00 - 00:59)</option>
                    <option value="1">丑時 (01:00 - 02:59)</option>
                    <option value="2">寅時 (03:00 - 04:59)</option>
                    <option value="3">卯時 (05:00 - 06:59)</option>
                    <option value="4">辰時 (07:00 - 08:59)</option>
                    <option value="5">巳時 (09:00 - 10:59)</option>
                    <option value="6">午時 (11:00 - 12:59)</option>
                    <option value="7">未時 (13:00 - 14:59)</option>
                    <option value="8">申時 (15:00 - 16:59)</option>
                    <option value="9">酉時 (17:00 - 18:59)</option>
                    <option value="10">戌時 (19:00 - 20:59)</option>
                    <option value="11">亥時 (21:00 - 22:59)</option>
                </select>
            </div>
            <button class="btn-main" style="margin-top: 15px;" onclick="calculate()">開啟流年命盤</button>
        </div>

        <div class="loader" id="loader"></div>

        <div class="card" id="result-section">
            <div style="text-align: center;">
                <span class="year-tag">2026 丙午 火馬年</span>
            </div>
            
            <div class="missing-element-display">
                <p style="color: var(--text-muted); font-size: 0.9rem;">您的五行能量缺口</p>
                <h2 class="element-big" id="res-element">金 Metal</h2>
                <p style="color: var(--accent-gold); font-size: 0.9rem;" id="res-keyword">年度關鍵字：淬鍊成金．建立權威</p>
            </div>

            <div class="fortune-block">
                <h3>✦ 2026 流年運勢深度解析</h3>
                <p id="res-fortune-career"></p>
                <p id="res-fortune-health"></p>
            </div>

            <div class="crystal-section-title">✦ 命定水晶推薦</div>
            <div id="crystal-container"></div>

            <button class="btn-main" style="margin-top: 25px;" onclick="window.open('https://ltep.meepshoper.com/', '_blank')">
                ✦ 前往官網 選購命定水晶
            </button>

            <button class="btn-main btn-ghost" style="margin-top: 15px;" onclick="reset()">
                重新測算
            </button>
        </div>
    </div>

    <script>
        const mSel = document.getElementById('month');
        const dSel = document.getElementById('day');
        for(let i=1;i<=12;i++) mSel.add(new Option(i+"月", i));
        for(let i=1;i<=31;i++) dSel.add(new Option(i+"日", i));

        // 關鍵修改：使用固定的 Seed (種子碼)，確保圖片被快取，不再每次重算
        // Prompt 優化：強調 raw crystal, macro photography, natural lighting
        const getCrystalImage = (keyword, fixedSeed) => {
            const prompt = `raw ${keyword} mineral specimen, high quality macro photography, natural soft lighting, 8k resolution, photorealistic, no blur`;
            // 將 prompt 轉為 URL 編碼
            const encodedPrompt = encodeURIComponent(prompt);
            // 加上 nologo=true 去除浮水印
            // 加上 seed=${fixedSeed} 讓圖片固定，瀏覽器會快取，速度極快
            return `https://image.pollinations.ai/prompt/${encodedPrompt}?width=250&height=250&nologo=true&seed=${fixedSeed}&model=flux`;
        };

        const db = [
            { 
                type: '金 (Metal)', 
                keyword: '年度關鍵字：高壓淬鍊．去蕪存菁',
                fortuneCareer: `
                    <span class="highlight-text">【機遇】</span>：古語云「真金不怕火煉」。2026年對您而言是「職涯含金量」大增的一年。職場能見度高，有機會承接高難度專案，一旦成功將確立您的權威地位。<br>
                    <span class="highlight-text">【挑戰】</span>：火剋金，過程絕對不輕鬆。您會明顯感受到來自上司或市場的「壓迫感」，容易感到焦慮、神經緊繃，甚至有想放棄的念頭。財務上需防耳根子軟，容易因面子問題而破費。<br>
                    <span class="highlight-text">【建議】</span>：適合從事金融、法律、精密工業等講求原則的行業。今年策略是「守住底線」，不要盲目擴張。面對壓力時，請視為雕塑鑽石的必經過程。
                `,
                fortuneHealth: `
                    <span class="highlight-text">【身心建議】</span>：金主呼吸系統。火旺之年容易有呼吸道敏感、皮膚乾癢等「燥」症。
                    <br>✦ 建議：多進行深呼吸練習，保持室內濕度。心理上要建立「情緒防火牆」，不要讓外人的評價輕易灼傷您的自信。
                `,
                recommendations: [
                    {
                        name: '1. 鈦晶 (Rutilated Quartz)',
                        desc: '「強勢的正財之光」。金黃髮絲對應太陽輪，為您披上能量盔甲，將職場壓力轉化為前進動力。',
                        imgKey: 'Gold%20Rutilated%20Quartz',
                        seed: 101 // 固定種子碼
                    },
                    {
                        name: '2. 白幽靈 (White Phantom)',
                        desc: '「心靈的淨化器」。在躁動的年份，幫助思緒如冰雪般清晰，做出理性決策，避免衝動漏財。',
                        imgKey: 'White%20Phantom%20Quartz%20Crystal',
                        seed: 102
                    },
                    {
                        name: '3. 月光石 (Moonstone)',
                        desc: '「溫柔的守護者」。柔和光暈中和外在尖銳火氣，提升人格魅力，保有圓融人際關係。',
                        imgKey: 'White%20Moonstone%20Gemstone',
                        seed: 103
                    }
                ]
            },
            { 
                type: '木 (Wood)', 
                keyword: '年度關鍵字：才華燃燒．過猶不及',
                fortuneCareer: `
                    <span class="highlight-text">【機遇】</span>：木生火，2026年是您「才華變現」的關鍵年！您的創意與構想極易被看見，是團隊中的靈感核心，名聲傳播速度極快。<br>
                    <span class="highlight-text">【挑戰】</span>：火旺則木焚。最大的危機是「過度燃燒」。您可能會因為太想表現或不懂拒絕，導致精力被掏空，出現「做很多但回收不成比例」的疲勞感，甚至創意枯竭。<br>
                    <span class="highlight-text">【建議】</span>：適合教育、設計、寫作等輸出型行業。但切記「留得青山在」，必須嚴格控管工作時間。多學習新知（進修）是為自己添加燃料的唯一途徑，避免被榨乾。
                `,
                fortuneHealth: `
                    <span class="highlight-text">【身心建議】</span>：木主肝與神經。才思敏捷的代價是腦神經衰弱與睡眠品質下降，需嚴防過勞。
                    <br>✦ 建議：強迫自己「放空」。接觸大自然（森林浴）是最好的充電方式。眼睛容易疲勞，需控制3C使用時間。
                `,
                recommendations: [
                    {
                        name: '1. 綠幽靈 (Green Phantom)',
                        desc: '「事業的推進器」。綠色光芒對應心輪，源源不絕補充被消耗的木氣，吸引貴人提攜。',
                        imgKey: 'Green%20Phantom%20Quartz%20Crystal',
                        seed: 201
                    },
                    {
                        name: '2. 綠髮晶 (Green Rutilated Quartz)',
                        desc: '「加薪之石」。能量如樹木扎根般強勁，增強事業企圖心，將創意轉化為實際薪資增長。',
                        imgKey: 'Green%20Rutilated%20Quartz',
                        seed: 202
                    },
                    {
                        name: '3. 孔雀石 (Malachite)',
                        desc: '「療癒與轉化」。美麗的同心圓紋路能吸收疲勞與負能量，守護內在平衡，防止身心透支。',
                        imgKey: 'Green%20Malachite%20Stone',
                        seed: 203
                    }
                ]
            },
            { 
                type: '水 (Water)', 
                keyword: '年度關鍵字：以柔克剛．逆勢突圍',
                fortuneCareer: `
                    <span class="highlight-text">【機遇】</span>：物以稀為貴。在火氣沖天的年份，缺水的您擁有眾人最缺乏的「冷靜視角」。您是最佳的剎車與策略師，能看見別人看不見的盲點。<br>
                    <span class="highlight-text">【挑戰】</span>：水火不容，衝突在所難免。您容易覺得周遭的人太浮躁、不講理，導致人際關係緊張，甚至感到孤立無援。職場溝通容易產生誤會。<br>
                    <span class="highlight-text">【建議】</span>：適合諮商、數據分析、物流或飲品業。千萬不要「硬碰硬」，那只會蒸發您的能量。請採取「迂迴戰術」，多用數據說話，少用情緒對抗。
                `,
                fortuneHealth: `
                    <span class="highlight-text">【身心建議】</span>：水主腎與循環。需注意水分攝取與代謝問題。情緒容易像海浪般起伏不定。
                    <br>✦ 建議：多親近水邊（游泳、泡澡）。煩躁時請暫時離開現場，喝杯水冷靜。學習冥想能有效調節您的磁場。
                `,
                recommendations: [
                    {
                        name: '1. 黑曜石 (Black Obsidian)',
                        desc: '「沈穩的定海神針」。吸收周遭躁氣，形成強大保護結界，在紛擾中穩住陣腳，防禦小人。',
                        imgKey: 'Black%20Obsidian%20Stone',
                        seed: 301
                    },
                    {
                        name: '2. 海藍寶 (Aquamarine)',
                        desc: '「溝通之石」。對應喉輪，幫助在火爆氣氛中說出有智慧的話語，開啟順暢人際關係。',
                        imgKey: 'Blue%20Aquamarine%20Crystal',
                        seed: 302
                    },
                    {
                        name: '3. 青金石 (Lapis Lazuli)',
                        desc: '「智慧的導航者」。深藍色帶金，能開啟洞察力，幫助看清局勢真相，精準抓住機會。',
                        imgKey: 'Blue%20Lapis%20Lazuli%20Stone',
                        seed: 303
                    }
                ]
            },
            { 
                type: '火 (Fire)', 
                keyword: '年度關鍵字：順風順水．慎防虛胖',
                fortuneCareer: `
                    <span class="highlight-text">【機遇】</span>：流年與本命相呼應，2026是您「借力使力」的最佳年份！過去推不動的計畫，今年大環境會推著您走。社交活躍，人脈快速擴張，適合拓展業務。<br>
                    <span class="highlight-text">【挑戰】</span>：雖然機會多，但容易陷入「虛胖」——雷聲大雨點小。可能談了很多合作，最後落實的卻不多。或者因為太過自信，忽視了細節執行，導致虎頭蛇尾。<br>
                    <span class="highlight-text">【建議】</span>：適合行銷、表演、科技或時尚業。務必強迫自己「落地執行」，不要只停留在想的階段。篩選無效社交，專注於能帶來實質效益的合作。
                `,
                fortuneHealth: `
                    <span class="highlight-text">【身心建議】</span>：火主心血管。雖然流年旺，但本命缺火者仍要注意「外熱內冷」，手腳冰冷問題可能依舊存在。
                    <br>✦ 建議：多曬太陽，保持規律的有氧運動讓身體真正熱起來。心態上要避免三分鐘熱度，培養耐心是今年的健康課題。
                `,
                recommendations: [
                    {
                        name: '1. 紫水晶 (Amethyst)',
                        desc: '「貴人之石」。提升社交智慧，在場合中如魚得水，將流年人氣轉化為實質貴人運。',
                        imgKey: 'Purple%20Amethyst%20Crystal',
                        seed: 401
                    },
                    {
                        name: '2. 石榴石 (Garnet)',
                        desc: '「生命力的泉源」。深紅光澤改善循環，在疲憊時迅速補充熱情與體力，助您堅持到底。',
                        imgKey: 'Red%20Garnet%20Gemstone',
                        seed: 402
                    },
                    {
                        name: '3. 太陽石 (Sunstone)',
                        desc: '「勝利的陽光」。充滿正向陽剛能量，驅散陰霾與恐懼，讓您自信爆棚，成為焦點。',
                        imgKey: 'Orange%20Sunstone%20Crystal',
                        seed: 403
                    }
                ]
            },
            { 
                type: '土 (Earth)', 
                keyword: '年度關鍵字：資源湧入．去留考驗',
                fortuneCareer: `
                    <span class="highlight-text">【機遇】</span>：火生土，2026年資源會主動流向您。無論是資金、物質或機會，您會發現今年「收穫」變得容易許多，是資產累積的黃金期。<br>
                    <span class="highlight-text">【挑戰】</span>：土若無根則鬆散。雖然進帳多，但若無規劃，很容易「財來財去一場空」。生活可能變得動盪（搬家、換工作、奔波），導致內心缺乏安全感，覺得飄泊不定。<br>
                    <span class="highlight-text">【建議】</span>：適合房地產、行政管理、倉儲或農業。今年的核心任務是「定」。強迫自己記帳、儲蓄、置產。對於變動，請視為擴大版圖的機會，而非災難。
                `,
                fortuneHealth: `
                    <span class="highlight-text">【身心建議】</span>：土主脾胃。豐收之年容易放縱口腹之慾，需特別注意腸胃負擔與體重管理。
                    <br>✦ 建議：飲食要規律，少吃生冷。容易焦慮不安時，接觸泥土（園藝、陶藝）或赤腳踩草地，能有效幫助您「接地氣」，找回平靜。
                `,
                recommendations: [
                    {
                        name: '1. 黃水晶 (Citrine)',
                        desc: '「財富聚寶盆」。主偏財，像磁鐵般將流年財富能量凝聚身邊，增強對財務的掌控力。',
                        imgKey: 'Yellow%20Citrine%20Crystal',
                        seed: 501
                    },
                    {
                        name: '2. 虎眼石 (Tiger\'s Eye)',
                        desc: '「王者的勇氣」。提升執行力與霸氣，幫助在機會面前果斷出手，穩穩守住勝利成果。',
                        imgKey: 'Golden%20Tiger%20Eye%20Stone',
                        seed: 502
                    },
                    {
                        name: '3. 茶晶 (Smoky Quartz)',
                        desc: '「穩重的守護者」。能量深沉接地，過濾浮躁病氣，保持腳踏實地，累積碩大成果。',
                        imgKey: 'Smoky%20Quartz%20Crystal',
                        seed: 503
                    }
                ]
            }
        ];

        function calculate() {
            const y = document.getElementById('year').value;
            const m = document.getElementById('month').value;
            const d = document.getElementById('day').value;
            let h = document.getElementById('hour').value;

            if(!y || !m || !d || !h) {
                alert("請輸入完整的生辰信息，以便我們為您進行解析。");
                return;
            }

            if (h === "-1") h = 0; 

            document.getElementById('input-card').style.display = 'none';
            document.getElementById('loader').style.display = 'block';

            // 縮短等待時間到 1.2秒 (因為圖片現在讀取很快了)
            setTimeout(() => {
                const sum = parseInt(y) + parseInt(m) + parseInt(d) + parseInt(h);
                const res = db[sum % 5]; 

                document.getElementById('res-element').innerText = res.type;
                document.getElementById('res-keyword').innerText = res.keyword;
                document.getElementById('res-fortune-career').innerHTML = res.fortuneCareer;
                document.getElementById('res-fortune-health').innerHTML = res.fortuneHealth;
                
                const container = document.getElementById('crystal-container');
                container.innerHTML = ''; 
                
                res.recommendations.forEach(crystal => {
                    const imgSrc = getCrystalImage(crystal.imgKey, crystal.seed);
                    
                    const cardHTML = `
                        <div class="crystal-card">
                            <div class="crystal-img-wrapper">
                                <img src="${imgSrc}" alt="${crystal.name}" onload="this.classList.add('loaded')">
                            </div>
                            <div class="crystal-content">
                                <h4>${crystal.name}</h4>
                                <p>${crystal.desc}</p>
                            </div>
                        </div>
                    `;
                    container.insertAdjacentHTML('beforeend', cardHTML);
                });

                document.getElementById('loader').style.display = 'none';
                document.getElementById('result-section').style.display = 'block';
            }, 1200);
        }

        function reset() {
            document.getElementById('result-section').style.display = 'none';
            document.getElementById('input-card').style.display = 'block';
        }
    </script>
</body>
</html>
